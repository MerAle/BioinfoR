Analysis1<-(Analysis, data.frame(t$Name, t$Number_Diseases*0.1, rep('01')))
Analysis1<-data.frame(t$Name, t$Number_Diseases*0.1, rep('01'))
Analysis<-data.frame(t$Name, t$Number_Diseases, rep('Original'))
Analysis1<-data.frame(t$Name, t$Number_Diseases*0.1, rep('01'))
Analysis5<-data.frame(t$Name, t$Number_Diseases*0.5, rep('05'))
colnames(Analysis)<-colnames(Analysis1)<-colnames(Analysis5)
colnames(Analysis)<-colnames(Analysis1)<-colnames(Analysis5)<-c('Name', 'Diseases', 'Group')
rbind(Analysis, Analysis1, Analysis5)
Analysisrbind(Analysis, Analysis1, Analysis5)
Analysis<-rbind(Analysis, Analysis1, Analysis5)
p+geom_line()
p+geom_line(group = 1)
p<-ggplot(Analysis, aes(x = Name, y = Diseaes, color=Group))
p+geom_line(group = 1)
p<-ggplot(Analysis, aes(x = Name, y = Diseaes, color=Group))
p+geom_line()
p<-ggplot(Analysis, aes(x = Name, y = Diseases, color=Group))
p+geom_line()
p<-ggplot(Analysis, aes(x = Name, y = Diseases, color=Group))
p+geom_line(group=1)
p<-ggplot(Analysis, aes(x = Name, y = Diseases, color=Group))
p+geom_line(group=1)+facet_grid(Group~.)
p<-ggplot(Analysis, aes(x = Name, y = Diseases, color=Group))
p+geom_line(group=1)+facet_grid(Group~., scales = 'free')
t
apply(t, 1, function(x){
rep(x[1],x[14] )
})
population<-apply(t, 1, function(x){
rep(x[1],x[14] )
})
population
population<-unlist(apply(t, 1, function(x){
rep(x[1],x[14] )
}))
population
population<-c(apply(t, 1, function(x){
rep(x[1],x[14] )
}))
population<-unlist(apply(t, 1, function(x){
rep(x[1],x[14] )
}))
population
population[[1]]
population[1]
sample(population, 1000, replace = FALSE)
population<-paste(apply(t, 1, function(x){
rep(x[1],x[14] )
}), collapse = "")
population
paste(as.character(apply(t, 1, function(x){
rep(x[1],x[14] )
})), collapse = "")
population<-unlist(apply(t, 1, function(x){
rep(x[1],x[14] )
}))
sample(population, 1000, replace = FALSE)
table(sample(population, 1000, replace = FALSE))
poptab<-table(sample(population, 1000, replace = FALSE))
Analysis_sam<-data.frame(poptab, rep('sample'))
Analysis_sam
colnames(Analysis_sam)<-c('Name', 'Diseases', 'Group')
Analysis<-rbind(Analysis, Analysis_sam)
p<-ggplot(Analysis, aes(x = Name, y = Diseases, color=Group))
p+geom_line(group=1)+facet_grid(Group~., scales = 'free')
Analysis_sam<-data.frame(poptab, rep('sample'))
Analysis<-rbind(Analysis, Analysis_sam)
Analysis
poptab<-table(sample(population, 1000, replace = FALSE))
poptab<-table(sample(population, 1000, replace = FALSE))
poptab2<-table(sample(population, 1000, replace = FALSE))
poptab4<-table(sample(population, 1000, replace = FALSE))
poptab1<-table(sample(population, 1000, replace = FALSE))
poptab3<-table(sample(population, 1000, replace = FALSE))
data.frame(poptab, poptab1, poptab2, poptab3, poptab4)
data.frame(poptab, poptab1[2], poptab2[2], poptab3[2], poptab4[2])
merge(poptab, poptab1, poptab2, poptab3, poptab4)
poptab<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab2<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab4<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab1<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab3<-data.frame(table(sample(population, 1000, replace = FALSE)))
merge(poptab, poptab1, poptab2, poptab3, poptab4)
merge(poptab, poptab1, poptab2, poptab3, poptab4 ,by = 'Var1')
merge(c(poptab, poptab1, poptab2, poptab3, poptab4) ,by = 'Var1')
c(poptab, poptab1, poptab2, poptab3, poptab4)
poptab<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab2<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab4<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab1<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab3<-data.frame(table(sample(population, 1000, replace = FALSE)))
apply(c( poptab1, poptab2, poptab3, poptab4), cbind(poptab, x))
cbind(poptab, poptab1, poptab2, poptab3, poptab4)
merge(poptab, poptab1, poptab2, poptab3, poptab4)
cbind(poptab, poptab1, poptab2, poptab3, poptab4)
T<-cbind(poptab, poptab1, poptab2, poptab3, poptab4)
View(`T`)
T<-T[,c(1,2,4,6,8,10)]
T$mean<-apply(T,1,FUN=function(x){mean(x[2:6])})
T$mean<-apply(T,1,FUN=function(x){print(x[2:6])})
apply(T,1,FUN=function(x){mean(x[2:6])})
T$mean<-apply(T,1,FUN=function(x){mean(as.numeric(x[2:6]))})
analysis_sam<-data.frame(T[,c("Var1", "mean")], rep('sample'))
colnames(Analysis_sam)<-c('Name', 'Diseases', 'Group')
Analysis<-rbind(Analysis, Analysis_sam)
p<-ggplot(Analysis, aes(x = Name, y = Diseases, color=Group))
p+geom_line(group=1)+facet_grid(Group~., scales = 'free')
genes<-data.frame(t$Name, t$Gene, rep('Genes'))
colnames(Analysis_sam)<-c('Name', 'Diseases', 'Group')
Analysis<-rbind(Analysis, Analysis_sam)
Analysis_sam<-data.frame(T[,c("Var1", "mean")], rep('sample'))
genes<-data.frame(t$Name, t$Gene, rep('Genes'))
colnames(Analysis_sam)<-colnames(genes)<-c('Name', 'Diseases', 'Group')
Analysis<-rbind(Analysis, Analysis_sam)
p<-ggplot(Analysis, aes(x = Name, y = Diseases, color=Group))
p+geom_line(group=1)+facet_grid(Group~., scales = 'free')
Analysis_sam<-data.frame(T[,c("Var1", "mean")], rep('sample'))
Analysis_sam
genes
colnames(Analysis_sam)<-colnames(genes)<-c('Name', 'Diseases', 'Group')
Analysis<-rbind(Analysis, Analysis_sam)
View(Analysis)
Analysis_sam<-data.frame(T[,c("Var1", "mean")], rep('sample'))
genes<-data.frame(t$Name, t$Gene, rep('Genes'))
colnames(Analysis_sam)<-colnames(genes)<-c('Name', 'Diseases', 'Group')
Analysis<-rbind(Analysis, Analysis_sam, genes)
p<-ggplot(Analysis, aes(x = Name, y = Diseases, color=Group))
p+geom_line(group=1)+facet_grid(Group~., scales = 'free')
Analysis<-data.frame(t$Name, t$Number_Diseases, rep('Original'))
Analysis1<-data.frame(t$Name, t$Number_Diseases*0.1, rep('01'))
Analysis5<-data.frame(t$Name, t$Number_Diseases*0.5, rep('05'))
colnames(Analysis)<-colnames(Analysis1)<-colnames(Analysis5)<-c('Name', 'Diseases', 'Group')
Analysis<-rbind(Analysis, Analysis1, Analysis5)
p<-ggplot(Analysis, aes(x = Name, y = Diseases, color=Group))
p+geom_line(group=1)+facet_grid(Group~., scales = 'free')
chisq.test(Analysis$t.Number_Diseases, p=t$Gene/sum(t$Gene))
library(ggplot2)
Analysis<-data.frame(t$Name, t$Number_Diseases, rep('Original'))
Analysis1<-data.frame(t$Name, t$Number_Diseases*0.1, rep('01'))
Analysis5<-data.frame(t$Name, t$Number_Diseases*0.5, rep('05'))
colnames(Analysis)<-colnames(Analysis1)<-colnames(Analysis5)<-c('Name', 'Diseases', 'Group')
Analysis<-rbind(Analysis, Analysis1, Analysis5)
p<-ggplot(Analysis, aes(x = Name, y = Diseases, color=Group))
p+geom_line(group=1)+facet_grid(Group~., scales = 'free')
# chisq.test(Analysis$t.Number_Diseases, p=t$Gene/sum(t$Gene))
population<-unlist(apply(t, 1, function(x){
rep(x[1],x[14] )
}))
poptab<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab2<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab4<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab1<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab3<-data.frame(table(sample(population, 1000, replace = FALSE)))
T<-cbind(poptab, poptab1, poptab2, poptab3, poptab4)
library(ggplot2)
Analysis<-data.frame(t$Name, t$Number_Diseases, rep('Original'))
Analysis1<-data.frame(t$Name, t$Number_Diseases*0.1, rep('01'))
Analysis5<-data.frame(t$Name, t$Number_Diseases*0.5, rep('05'))
colnames(Analysis)<-colnames(Analysis1)<-colnames(Analysis5)<-c('Name', 'Diseases', 'Group')
Analysis<-rbind(Analysis, Analysis1, Analysis5)
p<-ggplot(Analysis, aes(x = Name, y = Diseases, color=Group))
p+geom_line(group=1)+facet_grid(Group~., scales = 'free')
# chisq.test(Analysis$t.Number_Diseases, p=t$Gene/sum(t$Gene))
population<-unlist(apply(t, 1, function(x){
rep(x[1],x[14] )
}))
poptab<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab2<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab4<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab1<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab3<-data.frame(table(sample(population, 1000, replace = FALSE)))
T<-cbind(poptab, poptab1, poptab2, poptab3, poptab4)
T<-T[,c(1,2,4,6,8,10)]
T$mean<-apply(T,1,FUN=function(x){mean(as.numeric(x[2:6]))})
Analysis_sam<-data.frame(T[,c("Var1", "mean")], rep('sample'))
genes<-data.frame(t$Name, t$Gene, rep('Genes'))
colnames(Analysis_sam)<-colnames(genes)<-c('Name', 'Diseases', 'Group')
Analysis<-rbind(Analysis, Analysis_sam, genes)
p<-ggplot(Analysis, aes(x = Name, y = Diseases, color=Group))
p+geom_line(group=1)+facet_grid(Group~., scales = 'free')
library(ggplot2)
Analysis<-data.frame(t$Name, t$Number_Diseases, rep('Original'))
Analysis1<-data.frame(t$Name, t$Number_Diseases*0.1, rep('01'))
Analysis5<-data.frame(t$Name, t$Number_Diseases*0.5, rep('05'))
colnames(Analysis)<-colnames(Analysis1)<-colnames(Analysis5)<-c('Name', 'Diseases', 'Group')
Analysis<-rbind(Analysis, Analysis1, Analysis5)
# p<-ggplot(Analysis, aes(x = Name, y = Diseases, color=Group))
# p+geom_line(group=1)+facet_grid(Group~., scales = 'free')
# chisq.test(Analysis$t.Number_Diseases, p=t$Gene/sum(t$Gene))
population<-unlist(apply(t, 1, function(x){
rep(x[1],x[14] )
}))
poptab<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab2<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab4<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab1<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab3<-data.frame(table(sample(population, 1000, replace = FALSE)))
T<-cbind(poptab, poptab1, poptab2, poptab3, poptab4)
T<-T[,c(1,2,4,6,8,10)]
T$mean<-apply(T,1,FUN=function(x){mean(as.numeric(x[2:6]))})
Analysis_sam<-data.frame(T[,c("Var1", "mean")], rep('sample'))
genes<-data.frame(t$Name, t$Gene, rep('Genes'))
colnames(Analysis_sam)<-colnames(genes)<-c('Name', 'Diseases', 'Group')
Analysis<-rbind(Analysis, Analysis_sam, genes)
p<-ggplot(Analysis, aes(x = Name, y = Diseases, color=Group))
p+geom_line(group=1)+facet_grid(Group~., scales = 'free')
library(reshape2)
melt(t[1,12,14])
melt(t[, c(1,12,14)])
Pl<-melt(t[, c(1,12,14)])
Pl
ggplot(Pl, aes(x=Name, y = variable, fill= value))+geom_bar(position = 'dodge')
ggplot(Pl, aes(x=Name, y = variable, fill= value))+geom_bar(position = 'dodge', stat = 'identity')
View(Pl)
ggplot(Pl, aes(x=Name, y = value, fill=variable))+geom_bar(position = 'dodge', stat = 'identity')
Pl<-t[, c(1,12,14)]
Pl<-t[, c(1,12,14)]
t$Gene_prop<-t$Gene/sum(t$Gene)
t$Dis_prop<-t$Number_Diseases/sum(t$Number_Diseases)
Pl<-melt(t[, c(1,17,18)])
Pl
ggplot(Pl, aes(x=Name, y = value, fill=variable))+geom_bar(position = 'dodge', stat = 'identity')
qqplot(t$Gene_prop, t$Dis_prop)
qqline()
qqplot(t$Gene_prop, t$Dis_prop)
line()
qqplot(t$Gene_prop, t$Dis_prop)
qqline()
qqline(t$Gene_prop, t$Dis_prop)
qqplot(t$Gene_prop, t$Dis_prop)
qqplot(t$Gene_prop)
plot(t$Gene_prop, t$Dis_prop)
boxplot(t$Gene_prop, t$Dis_prop)
View(t)
p<-ggplot(Analysis, aes(x = Name, y = Diseases, color=Group))
p+geom_line(group=1)+facet_grid(Group~., scales = 'free')
ggplot(Pl, aes(x=Name, y = value, fill=variable))+geom_bar(position = 'dodge', stat = 'identity')
boxplot(t$Gene_prop/t$Dis_prop)
t$Ratio<-t$Gene_prop/t$Dis_prop
chisq.test(Analysis$t.Number_Diseases, p=t$Gene/sum(t$Gene))
chisq.test(Analysis$t.Number_Diseases, p=t$Gene/sum(t$Gene))
Analysis$t.Number_Diseases
chisq.test(t$Number_Diseases, p=t$Gene/sum(t$Gene))
effect.size
effect.size <-0.1
degrees <- 22
pwr.chisq.test(
w=effect.size,
N=NULL,            # Total number of observations
df=degrees,
power=0.9,        # 1 minus Type II probability
sig.level=0.001)    # Type I probability
effect.size <- ES.w1(t$Gene/sum(t$Gene), Analysis$t.Number_Diseases...0.1/sum(Analysis$t.Number_Diseases...0.1))
pwr.chisq.test(
w=effect.size,
N=NULL,            # Total number of observations
df=degrees,
power=0.9,        # 1 minus Type II probability
sig.level=0.001)
effect.size <- ES.w1(t$Gene/sum(t$Gene), Analysis$t.Number_Diseases/sum(Analysis$t.Number_Diseases))
degrees <- 22
pwr.chisq.test(
w=effect.size,
N=NULL,            # Total number of observations
df=degrees,
power=0.9,        # 1 minus Type II probability
sig.level=0.001)    # Type I probability
effect.size
effect.size <- ES.w1(t$Gene/sum(t$Gene), t$Number_Diseases/sum(t4Number_Diseases))
effect.size <- ES.w1(t$Gene/sum(t$Gene), t$Number_Diseases/sum(t$Number_Diseases))
degrees <- 22
pwr.chisq.test(
w=effect.size,
N=4000,            # Total number of observations
df=degrees,
power=NULL,        # 1 minus Type II probability
sig.level=0.001)    # Type I probability
pwr.chisq.test(
w=effect.size,
N=4000,            # Total number of observations
df=degrees,
power=0.9,        # 1 minus Type II probability
sig.level=NULL)    # Type I probability
effect.size <- ES.w1(t$Gene/sum(t$Gene), t$Number_Diseases/sum(t$Number_Diseases))
degrees <- 22
pwr.chisq.test(
w=effect.size,
N=4000,            # Total number of observations
df=degrees,
power=0.9,        # 1 minus Type II probability
sig.level=NULL)    # Type I probability
pwr.chisq.test(
w=effect.size,
N=4000,            # Total number of observations
df=degrees,
power=NULL,        # 1 minus Type II probability
sig.level=0.001)    # Type I probability
pwr.chisq.test(
w=effect.size,
N=4000,            # Total number of observations
df=degrees,
power=NULL,        # 1 minus Type II probability
sig.level=0.0005)    # Type I probability
pwr.chisq.test(
w=effect.size,
N=4000,            # Total number of observations
df=degrees,
power=NULL,        # 1 minus Type II probability
sig.level=0.000001)    # Type I probability
pwr.chisq.test(
w=effect.size,
N=4000,            # Total number of observations
df=degrees,
power=NULL,        # 1 minus Type II probability
sig.level=0.05)    # Type I probability
pwr.chisq.test(
w=effect.size,
N=3000,            # Total number of observations
df=degrees,
power=NULL,        # 1 minus Type II probability
sig.level=0.05)    # Type I probability
pwr.chisq.test(
w=effect.size,
N=3000,            # Total number of observations
df=degrees,
power=0.8,        # 1 minus Type II probability
sig.level=NULL)    # Type I probability
pwr.chisq.test(
w=effect.size,
N=1000,            # Total number of observations
df=degrees,
power=0.8,        # 1 minus Type II probability
sig.level=NULL)    # Type I probability
chisq.test(t$Number_Diseases, p=t$Gene/sum(t$Gene))
chisq.test(t$Number_Diseases*0.1, p=t$Gene/sum(t$Gene))
t$Number_Diseases*0.1
sum(t$Number_Diseases*0.1)
pwr.chisq.test(
w=effect.size,
N=1650,            # Total number of observations
df=degrees,
power=0.8,        # 1 minus Type II probability
sig.level=NULL)    # Type I probability
pwr.chisq.test(
w=effect.size,
N=1650,            # Total number of observations
df=degrees,
power=NULL,        # 1 minus Type II probability
sig.level=0.0015)    # Type I probability
pwr.chisq.test(
w=effect.size,
N=1650,            # Total number of observations
df=degrees,
power=0.9,        # 1 minus Type II probability
sig.level=NULL)    # Type I probability
pwr.chisq.test(
w=effect.size,
N=1650,            # Total number of observations
df=degrees,
power=0.8,        # 1 minus Type II probability
sig.level=NULL)    # Type I probability
pwr.chisq.test(
w=effect.size,
N=1650,            # Total number of observations
df=degrees,
power=0.99,        # 1 minus Type II probability
sig.level=NULL)    # Type I probability
library(ggplot2)
Analysis<-data.frame(t$Name, t$Number_Diseases, rep('Original'))
Analysis1<-data.frame(t$Name, t$Number_Diseases*0.1, rep('01'))
Analysis5<-data.frame(t$Name, t$Number_Diseases*0.5, rep('05'))
colnames(Analysis)<-colnames(Analysis1)<-colnames(Analysis5)<-c('Name', 'Diseases', 'Group')
Analysis<-rbind(Analysis, Analysis1, Analysis5)
# p<-ggplot(Analysis, aes(x = Name, y = Diseases, color=Group))
# p+geom_line(group=1)+facet_grid(Group~., scales = 'free')
# chisq.test(t$Number_Diseases*0.1, p=t$Gene/sum(t$Gene))
population<-unlist(apply(t, 1, function(x){
rep(x[1],x[14] )
}))
poptab<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab2<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab4<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab1<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab3<-data.frame(table(sample(population, 1000, replace = FALSE)))
T<-cbind(poptab, poptab1, poptab2, poptab3, poptab4)
Analysis<-data.frame(t$Name, t$Number_Diseases, rep('Original'))
Analysis1<-data.frame(t$Name, t$Number_Diseases*0.1, rep('01'))
Analysis5<-data.frame(t$Name, t$Number_Diseases*0.5, rep('05'))
colnames(Analysis)<-colnames(Analysis1)<-colnames(Analysis5)<-c('Name', 'Diseases', 'Group')
Analysis<-rbind(Analysis, Analysis1, Analysis5)
population<-unlist(apply(t, 1, function(x){
rep(x[1],x[14] )
}))
poptab2<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab4<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab1<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab3<-data.frame(table(sample(population, 1000, replace = FALSE)))
T<-cbind(poptab, poptab1, poptab2, poptab3, poptab4)
poptab<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab2<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab4<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab1<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab3<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab2<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab4<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab1<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab3<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab2<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab4<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab1<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab3<-data.frame(table(sample(population, 1000, replace = FALSE)))
T<-cbind(poptab, poptab1, poptab2, poptab3, poptab4)
T<-T[,c(1,2,4,6,8,10)]
T$mean<-apply(T,1,FUN=function(x){mean(as.numeric(x[2:6]))})
Analysis_sam<-data.frame(T[,c("Var1", "mean")], rep('sample'))
genes<-data.frame(t$Name, t$Gene, rep('Genes'))
colnames(Analysis_sam)<-colnames(genes)<-c('Name', 'Diseases', 'Group')
Analysis<-rbind(Analysis, Analysis_sam, genes)
p<-ggplot(Analysis, aes(x = Name, y = Diseases, color=Group))
p+geom_line(group=1)+facet_grid(Group~., scales = 'free')
p<-ggplot(Analysis, aes(x = Name, y = Diseases, color=Group))
p+geom_line(group=1)+facet_grid(Group~., scales = 'free')
Analysis_sam<-data.frame(T[,c("Var1", "mean")], rep('sample'))
genes<-data.frame(t$Name, t$Gene/t$`Size_(Mb)`, rep('Genes'))
colnames(Analysis_sam)<-colnames(genes)<-c('Name', 'Diseases', 'Group')
Analysis<-rbind(Analysis, Analysis_sam, genes)
p<-ggplot(Analysis, aes(x = Name, y = Diseases, color=Group))
p+geom_line(group=1)+facet_grid(Group~., scales = 'free')
library(ggplot2)
Analysis<-data.frame(t$Name, t$Number_Diseases, rep('Original'))
Analysis1<-data.frame(t$Name, t$Number_Diseases*0.1, rep('01'))
Analysis5<-data.frame(t$Name, t$Number_Diseases*0.5, rep('05'))
colnames(Analysis)<-colnames(Analysis1)<-colnames(Analysis5)<-c('Name', 'Diseases', 'Group')
Analysis<-rbind(Analysis, Analysis1, Analysis5)
# p<-ggplot(Analysis, aes(x = Name, y = Diseases, color=Group))
# p+geom_line(group=1)+facet_grid(Group~., scales = 'free')
# chisq.test(t$Number_Diseases*0.1, p=t$Gene/sum(t$Gene))
population<-unlist(apply(t, 1, function(x){
rep(x[1],x[14] )
}))
poptab<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab2<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab4<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab1<-data.frame(table(sample(population, 1000, replace = FALSE)))
poptab3<-data.frame(table(sample(population, 1000, replace = FALSE)))
T<-cbind(poptab, poptab1, poptab2, poptab3, poptab4)
T<-T[,c(1,2,4,6,8,10)]
T$mean<-apply(T,1,FUN=function(x){mean(as.numeric(x[2:6]))})
Analysis_sam<-data.frame(T[,c("Var1", "mean")], rep('sample'))
genes<-data.frame(t$Name, t$Gene/t$`Size_(Mb)`, rep('Genes'))
colnames(Analysis_sam)<-colnames(genes)<-c('Name', 'Diseases', 'Group')
Analysis<-rbind(Analysis, Analysis_sam, genes)
p<-ggplot(Analysis, aes(x = Name, y = Diseases, color=Group))
p+geom_line(group=1)+facet_grid(Group~., scales = 'free')
chisq.test(t$Number_Diseases*0.1, p=(t$Gene/t$`Size_(Mb)`)/(sum(t$Gene)/sum(t$`Size_(Mb)`)))
t$Gene/t$`Size_(Mb)`
(sum(t$Gene)/sum(t$`Size_(Mb)`)
)
(t$Gene/t$`Size_(Mb)`)/(sum(t$Gene)/sum(t$`Size_(Mb)`))
chisq.test(t$Number_Diseases*0.1, p=(t$Gene/t$`Size_(Mb)`)/(sum(t$Gene/t$`Size_(Mb)`)))
chisq.test(t$Number_Diseases*0.05, p=(t$Gene/t$`Size_(Mb)`)/(sum(t$Gene/t$`Size_(Mb)`)))
chisq.test(t$Number_Diseases*0.01, p=(t$Gene/t$`Size_(Mb)`)/(sum(t$Gene/t$`Size_(Mb)`)))
chisq.test(t$Number_Diseases*0.1, p=(t$Gene/t$`Size_(Mb)`)/(sum(t$Gene/t$`Size_(Mb)`)))
chisq.test(t$Number_Diseases*0.05, p=(t$Gene/t$`Size_(Mb)`)/(sum(t$Gene/t$`Size_(Mb)`)))
chisq.test(t$Number_Diseases*0.01, p=(t$Gene/t$`Size_(Mb)`)/(sum(t$Gene/t$`Size_(Mb)`)))
effect.size <- ES.w1((t$Gene/t$`Size_(Mb)`)/(sum(t$Gene/t$`Size_(Mb)`)), t$Number_Diseases/sum(t$Number_Diseases) )
effect.size
sum(t$Number_Diseases*0.01)
pwr.chisq.test(
w=effect.size,
N=sum(t$Number_Diseases*0.01),            # Total number of observations
df=degrees,
power=0.99,        # 1 minus Type II probability
sig.level=NULL)    # Type I probability
pwr.chisq.test(
w=effect.size,
N=sum(t$Number_Diseases*0.01),            # Total number of observations
df=degrees,
power=NULL,        # 1 minus Type II probability
sig.level=0.05)    # Type I probability
pwr.chisq.test(
w=effect.size,
N=sum(t$Number_Diseases*0.01),            # Total number of observations
df=degrees,
power=0.9,        # 1 minus Type II probability
sig.level=NULL)    # Type I probability
p<-ggplot(Analysis, aes(x = Name, y = Diseases, color=Group))
p+geom_line(group=1)+facet_grid(Group~., scales = 'free')
Analysis
View(Analysis)
View(Analysis_sam)
View(analysis_sam)
View(Analysis1)
View(Analysis5)
View(Basepairs)
# BASIC TABLE
link <- 'http://mscbioinformatics.uab.cat/base/documents/bioinformaticsintranet1718/summary_human_genome2015_10_18D22_6.txt'
header<-read.table(link, nrows = 1, stringsAsFactors = F)
# there is a missing column name, as we can see in https://www.ncbi.nlm.nih.gov/genome/51?genome_assembly_id=214366
t<-read.table(link, skip = 1 , stringsAsFactors = F)
colnames(t)<-c(  as.character(header[1:4]), "INSDC", as.character(header[5:12]))
# Also, the last row has a typo
t[26,2:13]<-c(as.character(t[26,3:13]), as.character(t[27,1]))
t<-t[1:26,]
# The variables are transformed to numeric
t[,6:13]<-apply(t[,6:13], 2, function(x){
x<-gsub(",","",x)
as.numeric(x)
})
View(t)
